(function(r,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("react/jsx-runtime"),require("@mui/material"),require("react"),require("axios"),require("@mui/icons-material/AccountCircleRounded"),require("@mui/icons-material/LogoutRounded"),require("@mui/icons-material/MenuRounded"),require("@mui/icons-material/NotificationsOutlined"),require("@mui/icons-material/SearchRounded"),require("@mui/material/AppBar"),require("@mui/material/Avatar"),require("@mui/material/Badge"),require("@mui/material/Box"),require("@mui/material/Divider"),require("@mui/material/IconButton"),require("@mui/material/InputAdornment"),require("@mui/material/Menu"),require("@mui/material/MenuItem"),require("@mui/material/Stack"),require("@mui/material/styles"),require("@mui/material/TextField"),require("@mui/material/Toolbar"),require("@mui/material/Typography"),require("@mui/material/useMediaQuery"),require("@mui/material/Card"),require("@mui/material/CardContent"),require("@mui/material/Button"),require("@mui/icons-material/AutoAwesomeRounded"),require("@mui/material/Tooltip"),require("@mui/icons-material/NotificationsRounded"),require("@mui/material/Drawer")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","@mui/material","react","axios","@mui/icons-material/AccountCircleRounded","@mui/icons-material/LogoutRounded","@mui/icons-material/MenuRounded","@mui/icons-material/NotificationsOutlined","@mui/icons-material/SearchRounded","@mui/material/AppBar","@mui/material/Avatar","@mui/material/Badge","@mui/material/Box","@mui/material/Divider","@mui/material/IconButton","@mui/material/InputAdornment","@mui/material/Menu","@mui/material/MenuItem","@mui/material/Stack","@mui/material/styles","@mui/material/TextField","@mui/material/Toolbar","@mui/material/Typography","@mui/material/useMediaQuery","@mui/material/Card","@mui/material/CardContent","@mui/material/Button","@mui/icons-material/AutoAwesomeRounded","@mui/material/Tooltip","@mui/icons-material/NotificationsRounded","@mui/material/Drawer"],e):(r=typeof globalThis<"u"?globalThis:r||self,e(r.LumoraWrapperComponent={},r.jsxRuntime,r.MaterialUI,r.React,r.axios,r.AccountCircleRoundedIcon,r.LogoutRoundedIcon,r.MenuRoundedIcon,r.NotificationsOutlinedIcon,r.SearchRoundedIcon,r.AppBar,r.Avatar,r.Badge,r.Box,r.Divider,r.IconButton,r.InputAdornment,r.Menu,r.MenuItem,r.Stack,r.styles,r.TextField,r.MuiToolbar,r.Typography,r.useMediaQuery,r.Card,r.CardContent,r.Button,r.AutoAwesomeRoundedIcon,r.Tooltip,r.NotificationsRoundedIcon,r.Drawer))})(this,function(r,e,u,p,V,te,ie,Te,ke,ye,Me,K,se,T,w,O,Ee,Ae,ae,h,De,Ce,Oe,x,qe,_e,Ue,ne,be,le,Be,ze){"use strict";function je(t){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const o in t)if(o!=="default"){const n=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(s,o,n.get?n:{enumerable:!0,get:()=>t[o]})}}return s.default=t,Object.freeze(s)}const G=je(p);let H=!1;const Le=()=>{H=!0},We=()=>{H=!1},Ne=V.create(),L=V.create({baseURL:{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_BASE_URL||"http://localhost:3000",headers:{"X-API-Key":{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_KEY||"","Content-Type":"application/json"}});L.interceptors.request.use(t=>{const s=localStorage.getItem("lumoraAccessToken");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t)),L.interceptors.response.use(t=>t,async t=>{var o;const s=t.config;if(((o=t.response)==null?void 0:o.status)===401&&H&&s&&!s._retry){s._retry=!0;try{const n=localStorage.getItem("lumoraRefreshToken");if(!n)throw new Error("No refresh token available");const l=await Ne.post(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_BASE_URL||"http://localhost:3000"}/auth/refresh`,{refresh_token:n},{headers:{"X-API-Key":{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_KEY||"","Content-Type":"application/json"}});if(l.data.success&&l.data.accessToken)return localStorage.setItem("lumoraAccessToken",l.data.accessToken),l.data.refreshToken&&localStorage.setItem("lumoraRefreshToken",l.data.refreshToken),s.headers.Authorization=`Bearer ${l.data.accessToken}`,L(s);throw new Error("Invalid refresh response")}catch(n){return localStorage.removeItem("lumoraAccessToken"),localStorage.removeItem("lumoraRefreshToken"),localStorage.removeItem("lumoraUser"),window.location.href="/login",Promise.reject(n)}}return Promise.reject(t)});const Pe=async()=>{const t=localStorage.getItem("lumoraRefreshToken");if(!t)throw new Error("No refresh token available for logout");await L.post("/auth/logout",{refresh_token:t})},Fe=async()=>{const t=localStorage.getItem("lumoraAccessToken"),s=localStorage.getItem("lumoraRefreshToken");if(t)return!0;if(s)try{const o=await V.post(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_BASE_URL||"http://localhost:3000"}/auth/refresh`,{refresh_token:s},{headers:{"X-API-Key":{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_KEY||"","Content-Type":"application/json"}});if(o.data.success&&o.data.accessToken)return localStorage.setItem("lumoraAccessToken",o.data.accessToken),o.data.refreshToken&&localStorage.setItem("lumoraRefreshToken",o.data.refreshToken),!0}catch(o){console.error("Token refresh failed:",o)}return localStorage.removeItem("lumoraAccessToken"),localStorage.removeItem("lumoraRefreshToken"),localStorage.removeItem("lumoraUser"),window.location.href="/login",!1},Ve=De.styled(Oe)({width:"100%",padding:"8px 16px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:"16px",flexShrink:0}),Ke=({appName:t="Dashboard",pageName:s="Home",onMenuClick:o,showMenuButton:n=!0,headerStyles:l,userName:c="User Name",userEmail:i,userAvatar:d,onProfileClick:m,onAccountClick:q,onSettingsClick:k,onLogout:g,showNotifications:S=!1,notificationCount:_=0,showSearchbar:I=!0,searchValue:U,onSearchChange:b,onSearchSubmit:B,showProfile:z=!0,userRole:Q,accentColor:X="#01584f",contentBackgroundColor:$="#f2f9fc",navbarBackground:Y="#ff0000",navbarAccentColor:f="#000000",rightExtraContent:W=[],customNavbar:y,customNavbarProps:v})=>{const N=qe(a=>a.breakpoints.up("md")),[P,F]=G.useState(null),J=!!P,M=a=>{b==null||b(a.target.value)},j=a=>{a.key==="Enter"&&B&&U&&B(U)},Z=a=>a?a.charAt(0).toUpperCase()+a.slice(1).toLowerCase():"User",R=a=>{F(a.currentTarget)},E=()=>{F(null)},A=a=>{a==null||a(),E()};return e.jsx(Me,{position:"fixed",sx:{boxShadow:0,background:Y,top:"var(--template-frame-height, 0px)",left:0,width:"100%",zIndex:1,height:"60px",...l},children:e.jsxs(Ve,{variant:"dense",sx:{height:"100%"},children:[e.jsxs(h,{direction:"row",sx:{alignItems:"center",gap:2,flexShrink:0,flexGrow:1},children:[n&&!N&&e.jsx(O,{"aria-label":"menu",onClick:o,sx:{color:f,"&:hover":{backgroundColor:"action.hover"}},children:e.jsx(Te,{})}),e.jsxs(h,{direction:"row",sx:{alignItems:"center",gap:1,flexShrink:0},children:[e.jsx(x,{variant:"h6",sx:{color:f,fontWeight:600,fontSize:"20px",lineHeight:1,textTransform:"uppercase"},children:t}),e.jsx("img",{src:"/lumora-logo.svg",alt:"NEXA Logo",width:24,height:24,style:{flexShrink:0}})]}),y?e.jsx(y,{...v||{}}):I&&N&&e.jsx(Ce,{placeholder:"Search for deals or documents...",value:U||"",onChange:M,onKeyDown:j,size:"small",sx:{width:"400px","& .MuiOutlinedInput-root":{backgroundColor:$,borderRadius:"8px","& fieldset":{borderColor:"transparent"},"&:hover fieldset":{borderColor:"transparent"},"&.Mui-focused fieldset":{borderColor:X}}},InputProps:{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(ye,{sx:{color:f}})})}})]}),e.jsxs(h,{direction:"row",sx:{alignItems:"center",gap:1.5,flexShrink:0},children:[S&&e.jsx(se,{color:"error",variant:"dot",invisible:_===0,sx:{"& .MuiBadge-badge":{right:2,top:2}},children:e.jsx(O,{size:"small",sx:{color:f},children:e.jsx(ke,{})})}),S&&z&&e.jsx(w,{orientation:"vertical",flexItem:!0,sx:{borderColor:"rgba(0, 0, 0, 0.12)",height:"24px",alignSelf:"center"}}),z&&e.jsxs(e.Fragment,{children:[e.jsxs(h,{direction:"row",onClick:R,sx:{alignItems:"center",gap:1,cursor:"pointer",borderRadius:"8px",padding:"4px 8px","&:hover":{backgroundColor:"action.hover"}},children:[d?e.jsx(K,{src:d,sx:{width:32,height:32}}):e.jsx(te,{sx:{width:32,height:32,color:f}}),e.jsxs(T,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:0},children:[e.jsx(x,{variant:"body2",sx:{color:f,fontWeight:500,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:c}),e.jsx(x,{variant:"caption",sx:{color:f,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:Z(Q)})]})]}),e.jsxs(Ae,{anchorEl:P,open:J,onClose:E,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},sx:{"& .MuiList-root":{padding:"4px"},"& .MuiPaper-root":{padding:0},"& .MuiDivider-root":{margin:"4px -4px"}},children:[e.jsx(ae,{onClick:()=>A(k),children:"Settings"}),e.jsx(w,{}),e.jsxs(ae,{onClick:()=>A(g),sx:{color:"error.main","&:hover":{color:"error.dark"}},children:[e.jsx(x,{sx:{flexGrow:1},children:"Logout"}),e.jsx(ie,{fontSize:"small"})]})]})]}),W.length!==0&&W.map(a=>a.type==="divider"?e.jsx(w,{orientation:"vertical",flexItem:!0,sx:{borderColor:"rgba(0, 0, 0, 0.12)",height:"24px",alignSelf:"center"}}):a.type==="profile"?e.jsxs(h,{direction:"row",onClick:a.onClick,sx:{alignItems:"center",gap:1,cursor:"pointer",borderRadius:"8px",padding:"4px 8px","&:hover":{backgroundColor:"action.hover"}},children:[a.avatar?e.jsx(K,{src:a.avatar,sx:{width:32,height:32}}):e.jsx(te,{sx:{width:32,height:32,color:f}}),e.jsxs(T,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:0},children:[e.jsx(x,{variant:"body2",sx:{color:f,fontWeight:500,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:a.name}),e.jsx(x,{variant:"caption",sx:{color:f,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:a.role})]})]}):null)]})]})})},ce=({title:t="",message:s="",buttonText:o="",onButtonClick:n,show:l=!0})=>l?e.jsx(_e,{variant:"outlined",sx:{m:1.5,flexShrink:0},children:e.jsxs(Ue,{children:[e.jsx(be,{fontSize:"small"}),e.jsx(x,{gutterBottom:!0,sx:{fontWeight:600},children:t}),e.jsx(x,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:s}),e.jsx(ne,{variant:"contained",size:"small",fullWidth:!0,onClick:n,children:o})]})}):null,de=({mainLinks:t,secondaryLinks:s=[],activePath:o,onLinkClick:n,accentColor:l="#01584f"})=>{const c=i=>{n&&n(i)};return e.jsxs(h,{sx:{flexGrow:1,justifyContent:"flex-start",alignItems:"center",pt:2,gap:1},children:[t.map((i,d)=>e.jsxs(G.Fragment,{children:[e.jsx(le,{title:i.text,placement:"right",arrow:!0,children:e.jsx(O,{component:"a",href:i.path,onClick:m=>{m.preventDefault(),m.stopPropagation(),c(i.path)},sx:{width:44,height:44,color:o===i.path?"#ffffff":l,backgroundColor:o===i.path?l:"transparent",borderRadius:o===i.path?"4px":"50%","&:hover":{backgroundColor:o===i.path?l:"action.hover",borderRadius:"4px"}},children:i.icon})}),d<t.length-1&&e.jsx(T,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(w,{sx:{width:"60%",borderColor:"divider"}})})]},d)),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{sx:{width:"100%",my:2,display:"flex",justifyContent:"center"},children:e.jsx(w,{sx:{width:"60%",borderColor:"divider"}})}),e.jsx(T,{sx:{mt:"auto",pb:2},children:e.jsx(h,{gap:1,alignItems:"center",children:s.map((i,d)=>e.jsxs(G.Fragment,{children:[e.jsx(le,{title:i.text,placement:"right",arrow:!0,children:e.jsx(O,{component:"a",href:i.path,onClick:m=>{m.preventDefault(),m.stopPropagation(),c(i.path)},sx:{width:48,height:48,color:o===i.path?"#ffffff":"text.secondary",backgroundColor:o===i.path?"#01584F":"transparent",borderRadius:o===i.path?"4px":"50%","&:hover":{backgroundColor:o===i.path?"#01584F":"action.hover",borderRadius:"4px"}},children:i.icon})}),d<s.length-1&&e.jsx(T,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(w,{sx:{width:"60%",borderColor:"divider"}})})]},d))})})]})]})},Ge=({open:t,onClose:s,mainLinks:o,secondaryLinks:n=[],activePath:l,onLinkClick:c,userName:i="User Name",userAvatar:d,onLogout:m,showNotifications:q=!1,notificationCount:k=0,alertProps:g,accentColor:S="#01584f"})=>{const _=I=>{c==null||c(I),s()};return e.jsx(ze,{anchor:"right",open:t,onClose:s,sx:{zIndex:I=>I.zIndex.drawer+1,"& .MuiDrawer-paper":{backgroundImage:"none",backgroundColor:"background.paper"}},children:e.jsxs(h,{sx:{maxWidth:"70dvw",height:"100%"},children:[e.jsxs(h,{direction:"row",sx:{p:2,pb:0,gap:1},children:[e.jsxs(h,{direction:"row",sx:{gap:1,alignItems:"center",flexGrow:1,p:1},children:[e.jsx(K,{sizes:"small",alt:i,src:d,sx:{width:24,height:24}}),e.jsx(x,{component:"p",variant:"h6",children:i})]}),q&&e.jsx(se,{color:"error",variant:"dot",invisible:k===0,sx:{"& .MuiBadge-badge":{right:2,top:2}},children:e.jsx(O,{size:"small",children:e.jsx(Be,{})})})]}),e.jsx(w,{}),e.jsxs(h,{sx:{flexGrow:1},children:[e.jsx(de,{mainLinks:o,secondaryLinks:n,activePath:l,onLinkClick:_,accentColor:S}),e.jsx(w,{})]}),(g==null?void 0:g.show)&&e.jsx(ce,{...g}),e.jsx(h,{sx:{p:2},children:e.jsx(ne,{variant:"outlined",fullWidth:!0,startIcon:e.jsx(ie,{}),onClick:m,children:"Logout"})})]})})},ue=({children:t,sidebarLinks:s=[],secondarySidebarLinks:o=[],appName:n="Dashboard",pageName:l="Home",showHeader:c=!0,showSidebar:i=!0,enableRefreshToken:d=!1,activePath:m,onLinkClick:q,userName:k,userEmail:g,userAvatar:S,onLogout:_,onProfileClick:I,onAccountClick:U,onSettingsClick:b,showNotifications:B=!0,notificationCount:z=0,showSearchbar:Q=!0,searchValue:X,onSearchChange:$,onSearchSubmit:Y,showProfile:f=!0,userRole:W,onVerify:y,alertProps:v,style:N,headerStyles:P,sidebarStyles:F,contentStyles:J,accentColor:M="#01584f",contentBackgroundColor:j="#f2f9fc",navbarBackground:Z="#ffffff",navbarAccentColor:R="#000000",GlobalChatSidebar:E,useChatSidebar:A,rightExtraContent:a,customNavbar:he,customNavbarProps:He})=>{const Qe=u.useTheme(),D=u.useMediaQuery(Qe.breakpoints.down("md")),[fe,pe]=p.useState(!1),[Xe,$e]=p.useState(!0),[Ye,Je]=p.useState(!1),[er,me]=p.useState(null),ee=A==null?void 0:A(),xe=(ee==null?void 0:ee.isOpen)??!1,re=p.useRef(y),ge=p.useRef(!1);p.useEffect(()=>{re.current=y},[y]);const Ze=()=>{pe(!fe)},Re=()=>{pe(!1)},we=Ie=>{localStorage.removeItem("lumoraAccessToken"),localStorage.removeItem("lumoraRefreshToken"),localStorage.removeItem("lumoraUser"),me(null),_(Ie)};return p.useEffect(()=>{(()=>{try{const oe=localStorage.getItem("lumoraRefreshToken"),rr=localStorage.getItem("lumoraAccessToken"),Se=localStorage.getItem("lumoraUser");if(!oe){console.log("No session found, redirecting to login"),localStorage.removeItem("lumoraAccessToken"),localStorage.removeItem("lumoraRefreshToken"),localStorage.removeItem("lumoraUser"),window.location.href="/login";return}if(Se&&!ge.current)try{const C=JSON.parse(Se),ve={name:C.name||"",email:C.email||"",profilePicture:C.profilePicture||"",role:C.role||""};me(ve),ge.current=!0,re.current&&re.current(ve)}catch(C){console.error("Error parsing user data from localStorage:",C),localStorage.removeItem("lumoraUser")}Je(!0)}catch(oe){console.error("Error checking session:",oe),localStorage.removeItem("lumoraAccessToken"),localStorage.removeItem("lumoraRefreshToken"),localStorage.removeItem("lumoraUser"),window.location.href="/login"}finally{$e(!1)}})()},[]),p.useEffect(()=>(d&&Le(),()=>{We()}),[d]),p.useEffect(()=>{d&&Fe()},[d]),Xe?e.jsxs(u.Box,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(u.CircularProgress,{size:60,thickness:4,sx:{color:M}}),e.jsx(u.Box,{sx:{mt:2,color:"text.secondary"},children:"Checking session..."})]}):Ye?e.jsxs(u.Box,{sx:{display:"flex",minHeight:"100vh",...N},children:[e.jsx(u.CssBaseline,{}),c&&e.jsx(Ke,{appName:n,pageName:l,onMenuClick:D&&i?Ze:void 0,showMenuButton:D&&i,headerStyles:P,userName:k,userEmail:g,userAvatar:S,onProfileClick:I,onAccountClick:U,onSettingsClick:b,onLogout:we,showNotifications:B,notificationCount:z,showSearchbar:Q&&!he,searchValue:X,onSearchChange:$,onSearchSubmit:Y,showProfile:f,userRole:W,accentColor:M,contentBackgroundColor:j,navbarBackground:Z,navbarAccentColor:R,rightExtraContent:a,customNavbar:he,customNavbarProps:He}),i&&!D&&e.jsx(u.Drawer,{variant:"permanent",sx:{width:80,flexShrink:0,zIndex:2,"& .MuiDrawer-paper":{width:80,boxSizing:"border-box",bgcolor:j,borderRight:"none",top:c?"60px":0,height:c?"calc(100vh - 60px)":"100vh"},...F},children:e.jsxs(u.Box,{sx:{overflow:"auto",height:"100%",display:"flex",flexDirection:"column",pt:2},children:[e.jsx(de,{mainLinks:s,secondaryLinks:o,activePath:m,onLinkClick:q,accentColor:M}),(v==null?void 0:v.show)&&e.jsx(ce,{...v})]})}),i&&D&&e.jsx(Ge,{open:fe,onClose:Re,mainLinks:s,secondaryLinks:o,activePath:m,onLinkClick:q,userName:k,userEmail:g,userAvatar:S,onLogout:we,onProfileClick:I,showNotifications:B,notificationCount:z,alertProps:v,accentColor:M}),e.jsx(u.Box,{component:"main",sx:{flexGrow:1,p:3,m:1,width:D?"100%":i?"calc(100% - 80px)":"100%",mt:c?"60px":0,ml:0,backgroundColor:j,...J},children:e.jsxs(u.Grid,{container:!0,spacing:3,children:[e.jsx(u.Grid,{size:{xs:12,md:xe&&E?8.5:12},sx:{display:"flex",flexDirection:"column"},children:t}),xe&&E&&e.jsx(u.Grid,{size:{xs:12,md:3.5},sx:{display:"flex",flexDirection:"column",position:{xs:"static",md:"sticky"},top:{xs:"auto",md:c?"60px":"0px"},alignSelf:"flex-start",height:{xs:"auto",md:c?"calc(100vh - 60px - 24px - 8px)":"calc(100vh - 24px - 8px)"},maxHeight:{xs:"none",md:c?"calc(100vh - 60px - 24px - 8px)":"calc(100vh - 24px - 8px)"}},children:e.jsx(E,{})})]})})]}):null};r.LumoraWrapper=ue,r.default=ue,r.logoutUser=Pe,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
