(function(r,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("react/jsx-runtime"),require("@mui/material"),require("react"),require("axios"),require("@mui/icons-material/AccountCircleRounded"),require("@mui/icons-material/LogoutRounded"),require("@mui/icons-material/MenuRounded"),require("@mui/icons-material/NotificationsOutlined"),require("@mui/icons-material/SearchRounded"),require("@mui/material/AppBar"),require("@mui/material/Avatar"),require("@mui/material/Badge"),require("@mui/material/Box"),require("@mui/material/Divider"),require("@mui/material/IconButton"),require("@mui/material/InputAdornment"),require("@mui/material/Menu"),require("@mui/material/MenuItem"),require("@mui/material/Stack"),require("@mui/material/styles"),require("@mui/material/TextField"),require("@mui/material/Toolbar"),require("@mui/material/Typography"),require("@mui/material/useMediaQuery"),require("@mui/material/Card"),require("@mui/material/CardContent"),require("@mui/material/Button"),require("@mui/icons-material/AutoAwesomeRounded"),require("@mui/material/Tooltip"),require("@mui/icons-material/NotificationsRounded"),require("@mui/material/Drawer")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","@mui/material","react","axios","@mui/icons-material/AccountCircleRounded","@mui/icons-material/LogoutRounded","@mui/icons-material/MenuRounded","@mui/icons-material/NotificationsOutlined","@mui/icons-material/SearchRounded","@mui/material/AppBar","@mui/material/Avatar","@mui/material/Badge","@mui/material/Box","@mui/material/Divider","@mui/material/IconButton","@mui/material/InputAdornment","@mui/material/Menu","@mui/material/MenuItem","@mui/material/Stack","@mui/material/styles","@mui/material/TextField","@mui/material/Toolbar","@mui/material/Typography","@mui/material/useMediaQuery","@mui/material/Card","@mui/material/CardContent","@mui/material/Button","@mui/icons-material/AutoAwesomeRounded","@mui/material/Tooltip","@mui/icons-material/NotificationsRounded","@mui/material/Drawer"],e):(r=typeof globalThis<"u"?globalThis:r||self,e(r.LumoraWrapperComponent={},r.jsxRuntime,r.MaterialUI,r.React,r.axios,r.AccountCircleRoundedIcon,r.LogoutRoundedIcon,r.MenuRoundedIcon,r.NotificationsOutlinedIcon,r.SearchRoundedIcon,r.AppBar,r.Avatar,r.Badge,r.Box,r.Divider,r.IconButton,r.InputAdornment,r.Menu,r.MenuItem,r.Stack,r.styles,r.TextField,r.MuiToolbar,r.Typography,r.useMediaQuery,r.Card,r.CardContent,r.Button,r.AutoAwesomeRoundedIcon,r.Tooltip,r.NotificationsRoundedIcon,r.Drawer))})(this,function(r,e,h,v,F,ee,re,fe,pe,xe,me,P,oe,T,g,C,ge,we,te,u,Ie,ve,Se,x,Te,ke,ye,ie,Me,ne,Ee,Ae){"use strict";function Ce(t){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const o in t)if(o!=="default"){const a=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,a.get?a:{enumerable:!0,get:()=>t[o]})}}return n.default=t,Object.freeze(n)}const K=Ce(v);let G=!1;const De=()=>{G=!0},qe=()=>{G=!1},Oe=F.create(),j=F.create({baseURL:{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_BASE_URL||"http://localhost:3000",headers:{"X-API-Key":{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_KEY||"","Content-Type":"application/json"}});j.interceptors.request.use(t=>{const n=localStorage.getItem("lumoraAccessToken");return n&&(t.headers.Authorization=`Bearer ${n}`),t},t=>Promise.reject(t)),j.interceptors.response.use(t=>t,async t=>{var o;const n=t.config;if(((o=t.response)==null?void 0:o.status)===401&&G&&n&&!n._retry){n._retry=!0;try{const a=localStorage.getItem("lumoraRefreshToken");if(!a)throw new Error("No refresh token available");const l=await Oe.post(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_BASE_URL||"http://localhost:3000"}/auth/refresh`,{refresh_token:a},{headers:{"X-API-Key":{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_KEY||"","Content-Type":"application/json"}});if(l.data.success&&l.data.accessToken)return localStorage.setItem("lumoraAccessToken",l.data.accessToken),l.data.refreshToken&&localStorage.setItem("lumoraRefreshToken",l.data.refreshToken),n.headers.Authorization=`Bearer ${l.data.accessToken}`,j(n);throw new Error("Invalid refresh response")}catch(a){return localStorage.removeItem("lumoraAccessToken"),localStorage.removeItem("lumoraRefreshToken"),window.location.href="/login",Promise.reject(a)}}return Promise.reject(t)});const _e=async()=>{const t=localStorage.getItem("lumoraRefreshToken");if(!t)throw new Error("No refresh token available for logout");await j.post("/auth/logout",{refresh_token:t})},be=async()=>{const t=localStorage.getItem("lumoraAccessToken"),n=localStorage.getItem("lumoraRefreshToken");if(t)return!0;if(n)try{const o=await F.post(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_BASE_URL||"http://localhost:3000"}/auth/refresh`,{refresh_token:n},{headers:{"X-API-Key":{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_API_KEY||"","Content-Type":"application/json"}});if(o.data.success&&o.data.accessToken)return localStorage.setItem("lumoraAccessToken",o.data.accessToken),o.data.refreshToken&&localStorage.setItem("lumoraRefreshToken",o.data.refreshToken),!0}catch(o){console.error("Token refresh failed:",o)}return localStorage.removeItem("lumoraAccessToken"),localStorage.removeItem("lumoraRefreshToken"),window.location.href="/login",!1},Be=Ie.styled(Se)({width:"100%",padding:"8px 16px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:"16px",flexShrink:0}),ze=({appName:t="Dashboard",pageName:n="Home",onMenuClick:o,showMenuButton:a=!0,headerStyles:l,userName:c="User Name",userEmail:i,userAvatar:d,onProfileClick:p,onAccountClick:D,onSettingsClick:k,onLogout:m,showNotifications:S=!1,notificationCount:y=0,showSearchbar:w=!0,searchValue:q,onSearchChange:O,onSearchSubmit:_,showProfile:b=!0,userRole:H,accentColor:Q="#01584f",contentBackgroundColor:X="#f2f9fc",navbarBackground:$="#ff0000",navbarAccentColor:f="#000000",rightExtraContent:U=[],customNavbar:I,customNavbarProps:Y})=>{const W=Te(s=>s.breakpoints.up("md")),[L,N]=K.useState(null),M=!!L,B=s=>{O==null||O(s.target.value)},J=s=>{s.key==="Enter"&&_&&q&&_(q)},Z=s=>s?s.charAt(0).toUpperCase()+s.slice(1).toLowerCase():"User",z=s=>{N(s.currentTarget)},E=()=>{N(null)},V=s=>{s==null||s(),E()};return e.jsx(me,{position:"fixed",sx:{boxShadow:0,background:$,top:"var(--template-frame-height, 0px)",left:0,width:"100%",zIndex:1,height:"60px",...l},children:e.jsxs(Be,{variant:"dense",sx:{height:"100%"},children:[e.jsxs(u,{direction:"row",sx:{alignItems:"center",gap:2,flexShrink:0,flexGrow:1},children:[a&&!W&&e.jsx(C,{"aria-label":"menu",onClick:o,sx:{color:f,"&:hover":{backgroundColor:"action.hover"}},children:e.jsx(fe,{})}),e.jsxs(u,{direction:"row",sx:{alignItems:"center",gap:1,flexShrink:0},children:[e.jsx(x,{variant:"h6",sx:{color:f,fontWeight:600,fontSize:"20px",lineHeight:1,textTransform:"uppercase"},children:t}),e.jsx("img",{src:"/lumora-logo.svg",alt:"NEXA Logo",width:24,height:24,style:{flexShrink:0}})]}),I?e.jsx(I,{...Y||{}}):w&&W&&e.jsx(ve,{placeholder:"Search for deals or documents...",value:q||"",onChange:B,onKeyDown:J,size:"small",sx:{width:"400px","& .MuiOutlinedInput-root":{backgroundColor:X,borderRadius:"8px","& fieldset":{borderColor:"transparent"},"&:hover fieldset":{borderColor:"transparent"},"&.Mui-focused fieldset":{borderColor:Q}}},InputProps:{startAdornment:e.jsx(ge,{position:"start",children:e.jsx(xe,{sx:{color:f}})})}})]}),e.jsxs(u,{direction:"row",sx:{alignItems:"center",gap:1.5,flexShrink:0},children:[S&&e.jsx(oe,{color:"error",variant:"dot",invisible:y===0,sx:{"& .MuiBadge-badge":{right:2,top:2}},children:e.jsx(C,{size:"small",sx:{color:f},children:e.jsx(pe,{})})}),S&&b&&e.jsx(g,{orientation:"vertical",flexItem:!0,sx:{borderColor:"rgba(0, 0, 0, 0.12)",height:"24px",alignSelf:"center"}}),b&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{direction:"row",onClick:z,sx:{alignItems:"center",gap:1,cursor:"pointer",borderRadius:"8px",padding:"4px 8px","&:hover":{backgroundColor:"action.hover"}},children:[d?e.jsx(P,{src:d,sx:{width:32,height:32}}):e.jsx(ee,{sx:{width:32,height:32,color:f}}),e.jsxs(T,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:0},children:[e.jsx(x,{variant:"body2",sx:{color:f,fontWeight:500,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:c}),e.jsx(x,{variant:"caption",sx:{color:f,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:Z(H)})]})]}),e.jsxs(we,{anchorEl:L,open:M,onClose:E,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},sx:{"& .MuiList-root":{padding:"4px"},"& .MuiPaper-root":{padding:0},"& .MuiDivider-root":{margin:"4px -4px"}},children:[e.jsx(te,{onClick:()=>V(k),children:"Settings"}),e.jsx(g,{}),e.jsxs(te,{onClick:()=>V(m),sx:{color:"error.main","&:hover":{color:"error.dark"}},children:[e.jsx(x,{sx:{flexGrow:1},children:"Logout"}),e.jsx(re,{fontSize:"small"})]})]})]}),U.length!==0&&U.map(s=>s.type==="divider"?e.jsx(g,{orientation:"vertical",flexItem:!0,sx:{borderColor:"rgba(0, 0, 0, 0.12)",height:"24px",alignSelf:"center"}}):s.type==="profile"?e.jsxs(u,{direction:"row",onClick:s.onClick,sx:{alignItems:"center",gap:1,cursor:"pointer",borderRadius:"8px",padding:"4px 8px","&:hover":{backgroundColor:"action.hover"}},children:[s.avatar?e.jsx(P,{src:s.avatar,sx:{width:32,height:32}}):e.jsx(ee,{sx:{width:32,height:32,color:f}}),e.jsxs(T,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:0},children:[e.jsx(x,{variant:"body2",sx:{color:f,fontWeight:500,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:s.name}),e.jsx(x,{variant:"caption",sx:{color:f,lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px"},children:s.role})]})]}):null)]})]})})},se=({title:t="",message:n="",buttonText:o="",onButtonClick:a,show:l=!0})=>l?e.jsx(ke,{variant:"outlined",sx:{m:1.5,flexShrink:0},children:e.jsxs(ye,{children:[e.jsx(Me,{fontSize:"small"}),e.jsx(x,{gutterBottom:!0,sx:{fontWeight:600},children:t}),e.jsx(x,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:n}),e.jsx(ie,{variant:"contained",size:"small",fullWidth:!0,onClick:a,children:o})]})}):null,ae=({mainLinks:t,secondaryLinks:n=[],activePath:o,onLinkClick:a,accentColor:l="#01584f"})=>{const c=i=>{a&&a(i)};return e.jsxs(u,{sx:{flexGrow:1,justifyContent:"flex-start",alignItems:"center",pt:2,gap:1},children:[t.map((i,d)=>e.jsxs(K.Fragment,{children:[e.jsx(ne,{title:i.text,placement:"right",arrow:!0,children:e.jsx(C,{component:"a",href:i.path,onClick:p=>{p.preventDefault(),p.stopPropagation(),c(i.path)},sx:{width:44,height:44,color:o===i.path?"#ffffff":l,backgroundColor:o===i.path?l:"transparent",borderRadius:o===i.path?"4px":"50%","&:hover":{backgroundColor:o===i.path?l:"action.hover",borderRadius:"4px"}},children:i.icon})}),d<t.length-1&&e.jsx(T,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(g,{sx:{width:"60%",borderColor:"divider"}})})]},d)),n.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{sx:{width:"100%",my:2,display:"flex",justifyContent:"center"},children:e.jsx(g,{sx:{width:"60%",borderColor:"divider"}})}),e.jsx(T,{sx:{mt:"auto",pb:2},children:e.jsx(u,{gap:1,alignItems:"center",children:n.map((i,d)=>e.jsxs(K.Fragment,{children:[e.jsx(ne,{title:i.text,placement:"right",arrow:!0,children:e.jsx(C,{component:"a",href:i.path,onClick:p=>{p.preventDefault(),p.stopPropagation(),c(i.path)},sx:{width:48,height:48,color:o===i.path?"#ffffff":"text.secondary",backgroundColor:o===i.path?"#01584F":"transparent",borderRadius:o===i.path?"4px":"50%","&:hover":{backgroundColor:o===i.path?"#01584F":"action.hover",borderRadius:"4px"}},children:i.icon})}),d<n.length-1&&e.jsx(T,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(g,{sx:{width:"60%",borderColor:"divider"}})})]},d))})})]})]})},je=({open:t,onClose:n,mainLinks:o,secondaryLinks:a=[],activePath:l,onLinkClick:c,userName:i="User Name",userAvatar:d,onLogout:p,showNotifications:D=!1,notificationCount:k=0,alertProps:m,accentColor:S="#01584f"})=>{const y=w=>{c==null||c(w),n()};return e.jsx(Ae,{anchor:"right",open:t,onClose:n,sx:{zIndex:w=>w.zIndex.drawer+1,"& .MuiDrawer-paper":{backgroundImage:"none",backgroundColor:"background.paper"}},children:e.jsxs(u,{sx:{maxWidth:"70dvw",height:"100%"},children:[e.jsxs(u,{direction:"row",sx:{p:2,pb:0,gap:1},children:[e.jsxs(u,{direction:"row",sx:{gap:1,alignItems:"center",flexGrow:1,p:1},children:[e.jsx(P,{sizes:"small",alt:i,src:d,sx:{width:24,height:24}}),e.jsx(x,{component:"p",variant:"h6",children:i})]}),D&&e.jsx(oe,{color:"error",variant:"dot",invisible:k===0,sx:{"& .MuiBadge-badge":{right:2,top:2}},children:e.jsx(C,{size:"small",children:e.jsx(Ee,{})})})]}),e.jsx(g,{}),e.jsxs(u,{sx:{flexGrow:1},children:[e.jsx(ae,{mainLinks:o,secondaryLinks:a,activePath:l,onLinkClick:y,accentColor:S}),e.jsx(g,{})]}),(m==null?void 0:m.show)&&e.jsx(se,{...m}),e.jsx(u,{sx:{p:2},children:e.jsx(ie,{variant:"outlined",fullWidth:!0,startIcon:e.jsx(re,{}),onClick:p,children:"Logout"})})]})})},le=({children:t,sidebarLinks:n=[],secondarySidebarLinks:o=[],appName:a="Dashboard",pageName:l="Home",showHeader:c=!0,showSidebar:i=!0,enableRefreshToken:d=!1,activePath:p,onLinkClick:D,userName:k,userEmail:m,userAvatar:S,onLogout:y,onProfileClick:w,onAccountClick:q,onSettingsClick:O,showNotifications:_=!0,notificationCount:b=0,showSearchbar:H=!0,searchValue:Q,onSearchChange:X,onSearchSubmit:$,showProfile:f=!0,userRole:U,alertProps:I,style:Y,headerStyles:W,sidebarStyles:L,contentStyles:N,accentColor:M="#01584f",contentBackgroundColor:B="#f2f9fc",navbarBackground:J="#ffffff",navbarAccentColor:Z="#000000",GlobalChatSidebar:z,useChatSidebar:E,rightExtraContent:V,customNavbar:s,customNavbarProps:Ue})=>{const We=h.useTheme(),A=h.useMediaQuery(We.breakpoints.down("md")),[ce,de]=v.useState(!1),[Le,Ne]=v.useState(!0),[Ve,Fe]=v.useState(!1),R=E==null?void 0:E(),he=(R==null?void 0:R.isOpen)??!1,Pe=()=>{de(!ce)},Ke=()=>{de(!1)};return v.useEffect(()=>{(()=>{try{if(!localStorage.getItem("lumoraRefreshToken")){console.log("No session found, redirecting to login"),window.location.href="/login";return}Fe(!0)}catch(ue){console.error("Error checking session:",ue),window.location.href="/login"}finally{Ne(!1)}})()},[]),v.useEffect(()=>(d&&De(),()=>{qe()}),[d]),v.useEffect(()=>{d&&be()},[d]),Le?e.jsxs(h.Box,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(h.CircularProgress,{size:60,thickness:4,sx:{color:M}}),e.jsx(h.Box,{sx:{mt:2,color:"text.secondary"},children:"Checking session..."})]}):Ve?e.jsxs(h.Box,{sx:{display:"flex",minHeight:"100vh",...Y},children:[e.jsx(h.CssBaseline,{}),c&&e.jsx(ze,{appName:a,pageName:l,onMenuClick:A&&i?Pe:void 0,showMenuButton:A&&i,headerStyles:W,userName:k,userEmail:m,userAvatar:S,onProfileClick:w,onAccountClick:q,onSettingsClick:O,onLogout:y,showNotifications:_,notificationCount:b,showSearchbar:H&&!s,searchValue:Q,onSearchChange:X,onSearchSubmit:$,showProfile:f,userRole:U,accentColor:M,contentBackgroundColor:B,navbarBackground:J,navbarAccentColor:Z,rightExtraContent:V,customNavbar:s,customNavbarProps:Ue}),i&&!A&&e.jsx(h.Drawer,{variant:"permanent",sx:{width:80,flexShrink:0,zIndex:2,"& .MuiDrawer-paper":{width:80,boxSizing:"border-box",bgcolor:B,borderRight:"none",top:c?"60px":0,height:c?"calc(100vh - 60px)":"100vh"},...L},children:e.jsxs(h.Box,{sx:{overflow:"auto",height:"100%",display:"flex",flexDirection:"column",pt:2},children:[e.jsx(ae,{mainLinks:n,secondaryLinks:o,activePath:p,onLinkClick:D,accentColor:M}),(I==null?void 0:I.show)&&e.jsx(se,{...I})]})}),i&&A&&e.jsx(je,{open:ce,onClose:Ke,mainLinks:n,secondaryLinks:o,activePath:p,onLinkClick:D,userName:k,userEmail:m,userAvatar:S,onLogout:y,onProfileClick:w,showNotifications:_,notificationCount:b,alertProps:I,accentColor:M}),e.jsx(h.Box,{component:"main",sx:{flexGrow:1,p:3,m:1,width:A?"100%":i?"calc(100% - 80px)":"100%",mt:c?"60px":0,ml:0,backgroundColor:B,...N},children:e.jsxs(h.Grid,{container:!0,spacing:3,children:[e.jsx(h.Grid,{size:{xs:12,md:he&&z?8.5:12},sx:{display:"flex",flexDirection:"column"},children:t}),he&&z&&e.jsx(h.Grid,{size:{xs:12,md:3.5},sx:{display:"flex",flexDirection:"column",position:{xs:"static",md:"sticky"},top:{xs:"auto",md:c?"60px":"0px"},alignSelf:"flex-start",height:{xs:"auto",md:c?"calc(100vh - 60px - 24px - 8px)":"calc(100vh - 24px - 8px)"},maxHeight:{xs:"none",md:c?"calc(100vh - 60px - 24px - 8px)":"calc(100vh - 24px - 8px)"}},children:e.jsx(z,{})})]})})]}):null};r.LumoraWrapper=le,r.default=le,r.logoutUser=_e,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
